<%- include('partials/header') %>

<div class="page-header">
  <div class="header-with-back">
    <a href="/movies" class="btn-back">â† Terug naar Films</a>
    <h1 id="movie-title-header">Film Details</h1>
  </div>
</div>

<!-- Messages -->
<div id="success-message" class="success-message" style="display: none;"></div>
<div id="error-message" class="error-message" style="display: none;"></div>

<!-- Loading -->
<div id="movie-loading" class="loading">
  <p>Film laden...</p>
</div>

<!-- Movie Details -->
<div id="movie-details" class="movie-detail-container" style="display: none;">
  <div class="movie-detail-card">
    <div class="movie-detail-header">
      <h2 id="movie-title"></h2>
      <div id="admin-actions" style="display: none;">
        <button id="edit-movie-btn" class="btn btn-primary">âœï¸ Bewerken</button>
        <button id="delete-movie-btn" class="btn btn-danger">ğŸ—‘ï¸ Verwijderen</button>
      </div>
    </div>

    <div class="movie-detail-info">
      <div class="info-item">
        <span class="info-label">ğŸ“… Jaar:</span>
        <span id="movie-year"></span>
      </div>
      <div class="info-item">
        <span class="info-label">ğŸ­ Genre:</span>
        <span id="movie-genre"></span>
      </div>
      <div class="info-item">
        <span class="info-label">ğŸ¬ Regisseur:</span>
        <span id="movie-director"></span>
      </div>
      <div class="info-item">
        <span class="info-label">â­ Gemiddelde Rating:</span>
        <span id="movie-rating"></span>
      </div>
    </div>
  </div>

  <!-- Reviews Section -->
  <div class="reviews-section">
    <h2>ğŸ“ Reviews</h2>

    <!-- Add Review (for logged in users) -->
    <div id="add-review-section" style="display: none;">
      <div class="add-review-card">
        <h3>Review Toevoegen</h3>
        <form id="add-review-form" class="review-form">
          <div class="form-group">
            <label for="review-rating">Rating *</label>
            <select id="review-rating" required>
              <option value="">Kies een rating</option>
              <option value="1">â­ 1 - Slecht</option>
              <option value="2">â­â­ 2 - Matig</option>
              <option value="3">â­â­â­ 3 - Gemiddeld</option>
              <option value="4">â­â­â­â­ 4 - Goed</option>
              <option value="5">â­â­â­â­â­ 5 - Uitstekend</option>
            </select>
          </div>
          <div class="form-group">
            <label for="review-comment">Commentaar</label>
            <textarea id="review-comment" rows="4" placeholder="Schrijf je review hier..."></textarea>
          </div>
          <button type="submit" class="btn btn-success">Review Plaatsen</button>
        </form>
      </div>
    </div>

    <!-- Login prompt for non-logged in users -->
    <div id="login-prompt" style="display: none;">
      <div class="info-box">
        <p>ğŸ”’ Log in om een review achter te laten</p>
        <a href="/login" class="btn btn-primary">Inloggen</a>
      </div>
    </div>

    <!-- Reviews List -->
    <div id="reviews-loading" class="loading">
      <p>Reviews laden...</p>
    </div>

    <div id="reviews-list" style="display: none;">
      <!-- Reviews worden hier via JavaScript geladen -->
    </div>

    <div id="no-reviews" style="display: none;">
      <p class="no-data">Nog geen reviews voor deze film</p>
    </div>
  </div>
</div>

<!-- Edit Movie Modal -->
<div id="movie-modal" class="modal" style="display: none;">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2>Film Bewerken</h2>
    <form id="movie-form">
      <input type="hidden" id="movie-id">

      <div class="form-group">
        <label for="edit-movie-title">Titel *</label>
        <input type="text" id="edit-movie-title" required>
      </div>

      <div class="form-group">
        <label for="edit-movie-year">Jaar *</label>
        <input type="number" id="edit-movie-year" min="1888" max="2100" required>
      </div>

      <div class="form-group">
        <label for="edit-movie-genre">Genre *</label>
        <input type="text" id="edit-movie-genre" required>
      </div>

      <div class="form-group">
        <label for="edit-movie-director">Regisseur *</label>
        <input type="text" id="edit-movie-director" required>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn-primary">Opslaan</button>
        <button type="button" class="btn btn-secondary" onclick="closeMovieModal()">Annuleren</button>
      </div>
    </form>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="delete-modal" class="modal" style="display: none;">
  <div class="modal-content modal-small">
    <h2>âš ï¸ Film Verwijderen</h2>
    <p>Weet je zeker dat je deze film wilt verwijderen?</p>
    <p><strong id="delete-movie-title"></strong></p>
    <p class="warning-text">Let op: Alle reviews van deze film worden ook verwijderd!</p>
    <div class="form-actions">
      <button id="confirm-delete" class="btn btn-danger">Verwijderen</button>
      <button class="btn btn-secondary" onclick="closeDeleteModal()">Annuleren</button>
    </div>
  </div>
</div>

<script src="/js/auth.js"></script>
<script src="/js/movie-detail.js"></script>

<%- include('partials/footer') %>
